# ultrasmall_phage_in_AMD
This repository contains code and relevant data used to generate results and figures for the manuscript "Biogeography and host interactions of CPR and DPANN viruses in acid mine drainage sediments across southeast China"
# Instructions for input data and code
### Figure 1
**S1.R**: R scripts used to generate the culmulation curve of vOTUs \
**S2.R**: R scripts used to examine the difference in isoelectric points of viral proteins between AMD and groundwater \
vConTACT2 \
**new-upset.R**: R scripts used to generate the upset plot in Fig. 1
### Figure 2
**Distance-decay analysis.R**: R scripts used to generate distance-decay relationships (DDRs) based on Bray-Curtis similarity of viral community compositions \
**Multivariate regression tree.R**: R scripts used to generate a multivariate regression tree analysis \
**NMDS.R**: R scripts used to generate a non-metric multidimensional scaling (NMDS) analysis and a multivariate analysis of variance based on distances and Permutations (PERMANOVA) \
**Normalized stochasticity ratio.R**: R scripts used to calculate normalized stochasticity ratio \
**Random forest.R**: R scripts used to generate a random forest analysis to assess the influence of abiotic factors on virus and host community variance 
### Figure 3
**RLM and ABT.R**: R scripts used to generate the refined viral lifestyle prediction results and conduct Robust Linear Regression (RLM) and Aggregated Boosted Tree (ABT) analyses \
**Fig3-abc.dynamic.R**: R scripts used to examine the correlation between virus-host dynamics and EC/pH \
**Fig3-d.microdiversity_heatmap.R**: R scripts used to generate a heatmap showing the correlation between viral microdiversities and abiotic factors 
### Figure 5
**partial correlation network.R**: R scripts used to conduct a partial correlation network to infer direct interactions between viruses and SHs
